---
title: shell 脚本
mySlug: shell scripts
tags:
  - shell
date: 2020-12-23T13:58:27.362Z
description: 使用 bash 编写脚本
---
# Shell 脚本

## bash

赋值语法 `foo=bar`，访问变量中存储的数值，其语法为 `$foo` 。使用空格分隔赋值语句，导致不能正常工作。在 Shell 脚本中使用空格会起到分割参数的作用。

```bash
# 此语句不能正常工作
foo = bar
```

Bash 中的字符串通过 `'` 和 `''` 分隔符来定义。但含义却不同，

- `'` 定义的字符串是原义字符串，其中的变量不会被转义。
- `''` 定义的字符串会就变量值进行替换。

```bash
foo=bar
echo "$foo"
# 打印 bar
echo '$foo'
# 打印 $foo
```

## 参数

bash 使用了很多特殊变量表示参数、错误代码和相关变量。

- `$0` 脚本名
- `$1~$9` $1代表第1个参数，一次类推。
- `$@` 所有参数
- `$#` 参数个数
- `$?` 前一个命令到返回值
- `$$` 当前脚本进程识别码
- `!!` 上一条命令
- `$_` 上一条命令的最后一个参数
- `STDOUT` 返回输出值
- `STDERR` 返回错误及错误码

## 操作符

`&&` 和 `||`

- 同一行的多个命令可以用 `;` 分隔
- 程序 `true` 返回码永远是 `0`
- 程序 `false` 返回码永远是 `1`

## 命令替换

以变量的形式获取一个命令的输出

`$( CMD )` 执行 `CMD` 命令，输出结果会替换掉 `$( CMD )`



```bash
bashuser~$ echo "We are in $(pwd)"
We are in /home/bashuser
```


## 进程替换

`<( CMD )` 会执行 `CMD` 并将结果输出到一个临时文件中，并将 `<( CMD )` 替换成临时文件名。

返回值会通过文件而不是 STDIN。

显示文件夹 `foo` 和 `bar` 中文件的区别。


```bash
bashuser~$ diff <(ls foo) <(ls bar)
```

## 通配符

- `?`
- `*`
- `{}`